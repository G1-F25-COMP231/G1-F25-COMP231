<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Add Entry ‚Äî BudgetMind AI</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='dashboard.css') }}">
</head>
<body>
  <div class="app">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="brand">
        <div class="brand__logo">üí†</div>
        <div class="brand__name">BudgetMind AI</div>
      </div>

      <nav class="nav">
        <a class="nav__item" href="/dashboard.html"><span>üè†</span> Dashboard</a>
        <a class="nav__item" href="/ai-insights"><span>üí°</span> AI Insights</a>
        <a class="nav__item active" href="/entry"><span>üßæ</span> Add Entry</a>
        <a class="nav__item" href="{{ url_for('budget_limit_page') }}"><span>üí∞</span> Budget Limit</a>
      </nav>

      <div class="nav__footer">
        <a class="nav__item logout" href="#"><span>‚Ü©Ô∏è</span> Logout</a>
      </div>
    </aside>

    <!-- Main -->
    <main class="main">
      <!-- Topbar -->
      <header class="topbar">
        <button class="icon-btn" id="toggleSidebar">‚ò∞</button>
        <div class="search">
          <input type="text" placeholder="Search transactions..." />
        </div>
      </header>

      <!-- Content -->
      <section class="content">
        <h1>Add New Entry</h1>

        <div class="card entry-card">
          <form id="entryForm" class="entry-form">
            <div class="form-group">
              <label for="type">Transaction Type</label>
              <select name="type" id="type" required>
                <option value="Income">Income</option>
                <option value="Expense">Expense</option>
              </select>
            </div>

            <div class="form-group">
              <label for="category">Category</label>
              <input type="text" name="category" id="category" placeholder="e.g. Dining, Bills, Travel" required>
            </div>

            <div class="form-group">
              <label for="amount">Amount ($)</label>
              <input type="number" name="amount" id="amount" step="0.01" required>
            </div>

            <div class="form-actions">
              <button class="btn" type="submit">Add Entry</button>
            </div>
          </form>

          <!-- Success message -->
          <div id="successAlert" class="alert" style="display:none;">‚úÖ Entry added successfully!</div>
        </div>
      </section>
    </main>
  </div>

  <!-- Style -->
  <style>
    .entry-card {
      max-width: 600px;
      margin: 2rem auto;
      padding: 2rem;
      display: flex;
      flex-direction: column;
      gap: 1.2rem;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      border-radius: 16px;
    }

    .entry-form {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 0.3rem;
    }

    .form-group input,
    .form-group select {
      padding: 0.6rem;
      border-radius: 8px;
      border: 1px solid #d0d0d0;
      font-size: 1rem;
    }

    .form-actions {
      text-align: right;
    }

    .btn {
      background: #0d6efd;
      color: white;
      padding: 0.7rem 1.2rem;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 500;
      transition: background 0.3s ease;
    }

    .btn:hover {
      background: #0b5ed7;
    }

    h1 {
      font-size: 1.8rem;
      text-align: center;
      margin-bottom: 1rem;
    }

    .alert {
      background: #d1e7dd;
      color: #0f5132;
      border: 1px solid #badbcc;
      padding: 0.8rem 1rem;
      border-radius: 8px;
      margin-top: 1rem;
      font-weight: 500;
      text-align: center;
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-5px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>

  <!-- Script -->
  <script>
  document.getElementById("entryForm").addEventListener("submit", async function(e) {
    e.preventDefault();

    const form = e.target;
    const data = new FormData(form);
    const payload = new URLSearchParams(data);

    try {
      const res = await fetch("/entry", {
        method: "POST",
        body: payload
      });
      const result = await res.json();

      if (result.ok) {
        const alertBox = document.getElementById("successAlert");
        alertBox.style.display = "block";
        form.reset();

        // Hide alert after 2 seconds
        setTimeout(() => {
          alertBox.style.display = "none";
        }, 2000);
      } else {
        alert("‚ö†Ô∏è " + (result.message || "Something went wrong."));
      }
    } catch (err) {
      alert("‚ùå Network error. Please try again.");
      console.error(err);
    }
  });
  </script>
</body>
</html>
