<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BudgetMind AI â€” Edit Profile</title>
  <link rel="stylesheet" href="static/settings.css" />

  <!-- Pass userId from session to JS -->
  <script>
    window.userId = "{{ session.get('user_id') }}";
  </script>
</head>
<body>
  <div class="app">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="brand">
        <div class="brand__logo">ğŸ’ </div>
        <div class="brand__name">BudgetMind AI</div>
      </div>
      <nav class="nav">
        <a href="/dashboard.html" class="nav__item">ğŸ  Dashboard</a>
        <a href="/settings.html" class="nav__item">âš™ï¸ Settings</a>
        <a href="/edit-profile.html" class="nav__item active">ğŸ‘¤ Edit Profile</a>
        <a href="/logout" class="nav__item logout">â†©ï¸ Logout</a>
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="main">
      <header class="topbar">
        <button class="icon-btn" id="toggleSidebar">â˜°</button>
        <h1 class="page-title">Edit Profile</h1>
      </header>

      <section class="content">
        <!-- Profile Edit Form -->
        <form id="profileForm" class="card form-card" enctype="multipart/form-data">
          <div class="form-group">
            <label for="fullName">Full Name</label>
            <input type="text" id="fullName" name="fullName" placeholder="John Doe" />
          </div>

          <div class="form-group">
            <label for="email">Email Address</label>
            <input type="email" id="email" name="email" placeholder="you@example.com" />
          </div>

          <div class="form-group">
            <label for="username">Username</label>
            <input type="text" id="username" name="username" placeholder="username" />
          </div>

          <div class="form-group">
            <label for="newPassword">New Password (Optional)</label>
            <input type="password" id="newPassword" name="newPassword" placeholder="Enter new password" />
          </div>

          <!-- Profile Picture Preview -->
          <img
            id="profilePreview"
            src=""
            style="width:120px;height:120px;border-radius:50%;object-fit:cover;display:block;margin-bottom:15px;"
          />

          <div class="form-group">
            <label for="profilePic">Profile Picture</label>
            <input type="file" id="profilePic" name="profilePic" accept="image/*" />
          </div>

          <button type="submit" class="btn-save">ğŸ’¾ Save Changes</button>
        </form>

        <hr class="divider" />

        <!-- Two-Factor Authentication -->
        <section class="twofa-section card">
          <h2>Two-Factor Authentication</h2>
          <p class="muted">Add an extra layer of protection to your account using Google Authenticator.</p>

          <!-- Action Buttons -->
          <div class="twofa-actions">
            <button id="enable2FA" type="button" class="btn-save">ğŸ”’ Enable 2FA</button>
            <button id="disable2FA" type="button" class="btn-delete hidden">âŒ Disable 2FA</button>
          </div>

          <!-- QR Code Display -->
          <div id="qrContainer" class="hidden">
            <p>ğŸ“± Scan this QR code using Google Authenticator:</p>
            <img
              id="qrImage"
              src=""
              alt="QR Code"
              style="max-width:220px;margin:1rem auto;display:block;"
            />
            <p><b>Secret Key:</b> <span id="qrSecret"></span></p>
            <p class="muted small">
              Once scanned, enter the 6-digit code in your authenticator app to verify login.
            </p>
          </div>

          <!-- Success Message -->
          <div id="twofaMessage" class="alert success hidden"></div>
        </section>

        <hr class="divider" />

        <!-- Bank Connection (Plaid Sandbox) -->
        <section class="card" style="margin-top: 20px;">
          <h2>Bank Connection</h2>
          <p id="bankStatusText">Checking bank connectionâ€¦</p>
          <p>Current Balance: <span id="bankBalanceText">--</span></p>
          <button id="bankConnectBtn" type="button" class="btn-save">
            Connect Sandbox Bank
          </button>
        </section>
      </section>

      <footer class="footer">
        <a href="#">About</a> Â· <a href="#">Contact Support</a> Â· <a href="#">Privacy</a>
      </footer>
    </main>
  </div>

  <!-- JS -->
  <script src="static/edit_profile.js"></script>
  <script src="static/bank_connect.js"></script>
</body>
</html>
